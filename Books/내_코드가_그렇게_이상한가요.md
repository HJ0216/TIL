# 내 코드가 그렇게 이상한가요?

📖 2024.03.11 -


## 3장 클래스 설계: 모든 것과 연결되는 설계 기반

### 3.2 성숙한 클래스로 성장시키는 설계 기법

```java
class Money{
    int amount;
    Currency currency;
}
```

⭐ 생성자로 확실하게 초기값 전달받기
```java
class Money{
    int amount;
    Currency currency;

    Money(int amount, Currency currency){
        this.amount = amount;
        this.currency = currency;
    }
}
```

⭐ 생성자로 전달되는 초기값 유효성 검사 추가
```java
class Money{
    int amount;
    Currency currency;

    Money(int amount, Currency currency){
        if(amount < 0){
            throw new IllegalArgumentException("금액은 0 이상의 값을 입력해주세요.");
        }
        if(currency == null){
            throw new NullPointerException("통화 단위를 지정해주세요.");
        }

        this.amount = amount;
        this.currency = currency;
    }
}
```

⭐ 데이터와 관련된 계산 로직 추가
```java
class Money{
    // 생략
    
    void add(int other){
        amount += other;
    }
}
```

⭐ 인스턴스 변수를 불변변수로 만들어 예상치 못한 동작 방어
```java
class Money{
    final int amount;
    final Currency currency;
    
    // 생략
}
```

⭐ 불변값의 변경이 필요할 경우, 새로운 인스턴스 만들기
```java
class Money{
    // 생략

    Money add(int other){
        int added = amount + other;
        return new Money(added, currency);
    }
}
```

⭐ 매개변수 및 지역변수를 불변으로 선언하여 예상치 못한 동작 방어
```java
class Money{
    // 생략

    Money add(final int other){
        final int added = amount + other;
        return new Money(added, currency);
    }
}
```

⭐ 엉뚱한 값을 전달하지 않도록 자료형을 지정하기
```java
class Money{
    // 생략

    Money add(final Money other){
        final int added = amount + other.amount;
        return new Money(added, currency);
    }
}
```

⭐ 메서드 로직에 유효성 검사 추가
```java
class Money{
    // 생략

    Money add(final Money other){
        if(!currency.equals(other.currency)){
            throw new IllegalArgumentException("통화 단위가 다릅니다.");
        }

        final int added = amount + other.amount;
        return new Money(added, currency);
    }
}
```

⭐ 의미없는 메서드는 추가하지 않기

🫠 최종
```java
class Money{
    final int amount;
    final Currency currency;

    Money(final int amount, final Currency currency){
        if(amount < 0){
            throw new IllegalArgumentException("금액은 0 이상의 값을 입력해주세요.");
        }

        if(currency == null){
            throw new NullPointerException("통화 단위를 지정해주세요.");
        }

        this.amount = amount;
        this.currency = currency;
    }

    Money add(final Money other){
        if(!currency.equals(other.currency)){
            throw new IllegalArgumentException("통화 단위가 다릅니다.");
        }

        final int added = amount + other.amount;
        return new Money(added, currency);
    }
}
```